<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Regina's Ultimativer Plan üéØ</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: #333;
            padding: 20px;
            min-height: 100vh;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
        }
        
        .header {
            text-align: center;
            color: white;
            margin-bottom: 30px;
            padding: 20px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            backdrop-filter: blur(10px);
        }
        
        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
        }
        
        .current-time {
            font-size: 1.2em;
            opacity: 0.9;
        }
        
        .quote-box {
            background: rgba(255, 255, 255, 0.95);
            padding: 15px 20px;
            border-radius: 10px;
            margin: 20px 0;
            border-left: 5px solid #f39c12;
            font-style: italic;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }
        
        .main-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }
        
        .card {
            background: white;
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            transition: transform 0.3s ease;
        }
        
        .card:hover {
            transform: translateY(-5px);
        }
        
        .card h2 {
            color: #667eea;
            margin-bottom: 20px;
            font-size: 1.5em;
            border-bottom: 3px solid #667eea;
            padding-bottom: 10px;
        }
        
        .decision-buttons {
            display: flex;
            flex-direction: column;
            gap: 15px;
            margin-top: 20px;
        }
        
        .btn {
            padding: 15px 25px;
            border: none;
            border-radius: 10px;
            font-size: 1.1em;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: left;
            position: relative;
            overflow: hidden;
        }
        
        .btn:hover {
            transform: scale(1.05);
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
        }
        
        .btn-artikel {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            color: white;
        }
        
        .btn-roman {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            color: white;
        }
        
        .btn-pause {
            background: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%);
            color: white;
        }
        
        .btn-small {
            padding: 10px 15px;
            font-size: 0.9em;
            margin-top: 10px;
        }
        
        .timer-display {
            font-size: 3em;
            text-align: center;
            color: #667eea;
            font-weight: bold;
            margin: 20px 0;
            font-family: 'Courier New', monospace;
        }
        
        .timer-controls {
            display: flex;
            gap: 10px;
            justify-content: center;
            flex-wrap: wrap;
        }
        
        .progress-bar {
            background: #e0e0e0;
            height: 25px;
            border-radius: 15px;
            overflow: hidden;
            margin: 15px 0;
            position: relative;
        }
        
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #667eea 0%, #764ba2 100%);
            transition: width 0.5s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            font-size: 0.9em;
        }
        
        .tracker-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px;
            background: #f8f9fa;
            border-radius: 8px;
            margin: 10px 0;
        }
        
        .tracker-label {
            font-weight: bold;
            color: #555;
        }
        
        .tracker-value {
            font-size: 1.2em;
            color: #667eea;
            font-weight: bold;
        }
        
        .increment-btn {
            background: #667eea;
            color: white;
            border: none;
            padding: 5px 15px;
            border-radius: 5px;
            cursor: pointer;
            margin-left: 10px;
            font-size: 1.2em;
        }
        
        .increment-btn:hover {
            background: #5568d3;
        }
        
        .week-planner {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 10px;
            margin-top: 20px;
        }
        
        .day-column {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 10px;
            min-height: 200px;
        }
        
        .day-header {
            font-weight: bold;
            text-align: center;
            margin-bottom: 10px;
            color: #667eea;
            font-size: 0.9em;
        }
        
        .task-item {
            background: white;
            padding: 8px;
            margin: 5px 0;
            border-radius: 5px;
            font-size: 0.85em;
            border-left: 3px solid #667eea;
            cursor: move;
            user-select: none;
        }
        
        .task-item.dragging {
            opacity: 0.5;
        }
        
        .task-item.in-pool {
            cursor: grab;
        }
        
        .task-item.in-pool:active {
            cursor: grabbing;
        }
        
        .day-column.drag-over {
            background: #e8f4f8;
            border: 2px dashed #667eea;
        }
        
        .task-roman { border-left-color: #4facfe; }
        .task-artikel { border-left-color: #f5576c; }
        .task-bsk { border-left-color: #f39c12; }
        .task-haushalt { border-left-color: #43e97b; }
        .task-kroatisch { border-left-color: #9b59b6; }
        
        .fixed-time {
            background: #fff3cd;
            padding: 5px;
            margin: 3px 0;
            border-radius: 3px;
            font-size: 0.75em;
            text-align: center;
            border: 1px dashed #f39c12;
        }
        
        .notes-area {
            width: 100%;
            min-height: 120px;
            padding: 15px;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            font-size: 1em;
            resize: vertical;
            margin-top: 10px;
        }
        
        .notes-area:focus {
            outline: none;
            border-color: #667eea;
        }
        
        .saved-notes {
            background: #f8f9fa;
            padding: 10px;
            border-radius: 8px;
            margin-top: 10px;
            max-height: 200px;
            overflow-y: auto;
        }
        
        .note-item {
            background: white;
            padding: 10px;
            margin: 5px 0;
            border-radius: 5px;
            border-left: 3px solid #f5576c;
            position: relative;
        }
        
        .note-date {
            font-size: 0.8em;
            color: #888;
            margin-bottom: 5px;
        }
        
        .delete-note {
            position: absolute;
            top: 5px;
            right: 5px;
            background: #e74c3c;
            color: white;
            border: none;
            border-radius: 3px;
            padding: 2px 8px;
            cursor: pointer;
            font-size: 0.8em;
        }
        
        .kroatisch-dialog {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 10px;
            margin: 10px 0;
            border-left: 4px solid #9b59b6;
        }
        
        .dialog-line {
            margin: 8px 0;
            padding: 8px;
            background: white;
            border-radius: 5px;
        }
        
        .german {
            color: #555;
            font-style: italic;
        }
        
        .croatian {
            color: #9b59b6;
            font-weight: bold;
            margin-top: 5px;
        }
        
        .play-audio {
            background: #9b59b6;
            color: white;
            border: none;
            padding: 5px 10px;
            border-radius: 5px;
            cursor: pointer;
            margin-left: 10px;
            font-size: 0.9em;
        }
        
        .dialog-selector {
            display: flex;
            gap: 10px;
            margin-bottom: 15px;
            flex-wrap: wrap;
        }
        
        .dialog-btn {
            padding: 8px 15px;
            background: #9b59b6;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 0.9em;
        }
        
        .dialog-btn.active {
            background: #764ba2;
            box-shadow: 0 0 10px rgba(155, 89, 182, 0.5);
        }
        
        .achievement {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            color: white;
            padding: 15px;
            border-radius: 10px;
            text-align: center;
            margin: 10px 0;
            font-weight: bold;
            display: none;
            animation: slideIn 0.5s ease;
        }
        
        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(-20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        .streak-counter {
            display: flex;
            justify-content: space-around;
            margin-top: 15px;
        }
        
        .streak-item {
            text-align: center;
        }
        
        .streak-number {
            font-size: 2em;
            font-weight: bold;
            color: #667eea;
        }
        
        .streak-label {
            font-size: 0.9em;
            color: #888;
        }
        
        .hidden {
            display: none;
        }
        
        @media (max-width: 768px) {
            .week-planner {
                grid-template-columns: 1fr;
            }
            
            .header h1 {
                font-size: 1.8em;
            }
            
            .timer-display {
                font-size: 2em;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üéØ Regina's Ultimativer Plan</h1>
            <div class="current-time" id="currentTime"></div>
        </div>
        
        <div class="quote-box" id="quoteBox">
            "Perfektion ist der Feind von 'fertig'. Und 'fertig' ist der Freund von 'weiter geht's'."
        </div>
        
        <!-- Assistent Check-In -->
        <div style="background: rgba(255, 255, 255, 0.95); padding: 20px; border-radius: 15px; margin: 20px 0; box-shadow: 0 4px 6px rgba(0,0,0,0.1);">
            <div style="display: flex; align-items: center; gap: 15px;">
                <div style="font-size: 2.5em;">ü§ñ</div>
                <div style="flex: 1;">
                    <strong style="color: #667eea; font-size: 1.1em;">Dein Assistent meint:</strong>
                    <div id="assistantOutput" style="margin-top: 8px; color: #555; font-size: 1.05em; line-height: 1.5;">
                        Bereit f√ºr den Tag?
                    </div>
                </div>
            </div>
        </div>
        
        <div class="main-grid">
            <!-- Mein Tag heute - √úbersicht -->
            <div class="card" style="grid-column: 1 / -1; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white;">
                <h2 style="color: white; border-bottom-color: rgba(255,255,255,0.3);">üåü Mein Tag heute</h2>
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 15px; margin-top: 15px;">
                    <div style="background: rgba(255,255,255,0.15); padding: 15px; border-radius: 10px;">
                        <div style="font-size: 2em; margin-bottom: 5px;" id="todayQuickLogCount">0</div>
                        <div style="font-size: 0.9em; opacity: 0.9;">Dinge erledigt</div>
                    </div>
                    <div style="background: rgba(255,255,255,0.15); padding: 15px; border-radius: 10px;">
                        <div style="font-size: 2em; margin-bottom: 5px;" id="todaySpontanDisplay">0</div>
                        <div style="font-size: 0.9em; opacity: 0.9;">Spontan-Tasks</div>
                    </div>
                    <div style="background: rgba(255,255,255,0.15); padding: 15px; border-radius: 10px;">
                        <div style="font-size: 2em; margin-bottom: 5px;" id="todayDeepWorkMins">0</div>
                        <div style="font-size: 0.9em; opacity: 0.9;">Min Deep Work</div>
                    </div>
                    <div style="background: rgba(255,255,255,0.15); padding: 15px; border-radius: 10px;">
                        <div style="font-size: 2em; margin-bottom: 5px;" id="todayStreaksDisplay">0/2</div>
                        <div style="font-size: 0.9em; opacity: 0.9;">Streaks heute</div>
                    </div>
                </div>
                <div style="margin-top: 15px; padding: 15px; background: rgba(255,255,255,0.1); border-radius: 10px;">
                    <strong>üéØ Heute geschafft:</strong>
                    <div id="todayAccomplishments" style="margin-top: 10px; line-height: 1.8;">
                        <em style="opacity: 0.7;">Trage deine ersten Erfolge ein...</em>
                    </div>
                </div>
            </div>
            
            <!-- Morgen-Entscheidung -->
            <div class="card">
                <h2>‚òÄÔ∏è Morgen-Entscheidung (5:15 Uhr)</h2>
                <p style="margin-bottom: 15px;">Was brennt heute in dir?</p>
                
                <div class="decision-buttons">
                    <button class="btn btn-artikel" onclick="selectMode('artikel')">
                        üìù Artikel-Reflex aktiviert
                        <div style="font-size: 0.8em; margin-top: 5px; opacity: 0.9;">
                            Notizen sammeln ‚Üí Sp√§ter ausformulieren
                        </div>
                    </button>
                    
                    <button class="btn btn-roman" onclick="selectMode('roman')">
                        üìö Roman ruft
                        <div style="font-size: 0.8em; margin-top: 5px; opacity: 0.9;">
                            90 Min Deep Work ‚Üí X/News schlie√üen!
                        </div>
                    </button>
                    
                    <button class="btn btn-pause" onclick="selectMode('pause')">
                        üåø Heute nicht, alles Schei√üe
                        <div style="font-size: 0.8em; margin-top: 5px; opacity: 0.9;">
                            Haushalt oder Kroatisch ‚Üí Kein Druck
                        </div>
                    </button>
                </div>
                
                <div id="modeResult" style="margin-top: 20px; padding: 15px; background: #f8f9fa; border-radius: 10px; display: none;">
                    <h3 style="color: #667eea; margin-bottom: 10px;">Dein Plan f√ºr heute:</h3>
                    <div id="modeText"></div>
                </div>
            </div>
            
            <!-- Timer -->
            <div class="card">
                <h2>‚è±Ô∏è Deep Work Timer</h2>
                <div class="timer-display" id="timerDisplay">90:00</div>
                <div class="timer-controls">
                    <button class="btn btn-small" style="background: #667eea; color: white;" onclick="startTimer(90)">90 Min Start</button>
                    <button class="btn btn-small" style="background: #f39c12; color: white;" onclick="startTimer(45)">45 Min Start</button>
                    <button class="btn btn-small" style="background: #43e97b; color: white;" onclick="startTimer(15)">15 Min Start</button>
                    <button class="btn btn-small" style="background: #e74c3c; color: white;" onclick="resetTimer()">Reset</button>
                </div>
                <div style="text-align: center; margin-top: 15px; color: #888; font-size: 0.9em;" id="timerStatus">
                    Timer bereit
                </div>
            </div>
            
            <!-- Morgen-Tagebuch -->
            <div class="card">
                <h2>üìù Heute schon erledigt</h2>
                <p style="margin-bottom: 10px; color: #666;">Kleine Erfolge z√§hlen auch!</p>
                
                <div style="display: flex; gap: 10px; margin-bottom: 15px;">
                    <input type="text" id="quickLogInput" placeholder="z.B. Katzen gef√ºttert, W√§sche gestartet..." style="flex: 1; padding: 10px; border: 2px solid #e0e0e0; border-radius: 8px; font-size: 1em;" onkeypress="if(event.key==='Enter') addQuickLog()">
                    <button class="btn btn-small" style="background: #667eea; color: white;" onclick="addQuickLog()">+ Hinzuf√ºgen</button>
                </div>
                
                <div id="quickLogList" style="background: #f8f9fa; padding: 15px; border-radius: 10px; min-height: 100px;">
                    <p style="color: #888; text-align: center; font-style: italic;">Noch nichts eingetragen</p>
                </div>
                
                <div style="margin-top: 15px; padding: 10px; background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%); color: white; border-radius: 8px; text-align: center;">
                    <strong style="font-size: 1.3em;" id="spontanCounter">0</strong> spontane Tasks heute
                    <button class="btn btn-small" style="background: rgba(255,255,255,0.3); color: white; margin-left: 10px;" onclick="incrementSpontan()">üê± +1</button>
                </div>
            </div>
            
            <!-- Artikel-Notizen VERBESSERT -->
<div class="card" style="grid-column: 1 / -1;">
    <h2>üìã Artikel-Notizen</h2>
    <p style="margin-bottom: 10px; color: #666;">
        ‚ú® URLs werden automatisch zu Links | Screenshots mit Strg+V einf√ºgen
    </p>
    
    <textarea class="notes-area" id="articleNote" placeholder="Schreib hier... URLs werden automatisch zu Links!

üì∑ Screenshot direkt einf√ºgen: Strg+V / Cmd+V (wie im Chat!)

Beispiel: https://tagesschau.de/artikel-xyz"></textarea>
    
    <div class="upload-section">
        <div id="pastedImage" style="display: none; margin-top: 10px;">
            <strong style="color: #43e97b;">‚úì Screenshot eingef√ºgt!</strong>
            <img id="previewImage" style="max-width: 200px; height: auto; margin-top: 5px; border-radius: 5px; display: block;">
            <button onclick="clearPastedImage()" style="background: #e74c3c; color: white; border: none; padding: 5px 10px; border-radius: 5px; cursor: pointer; margin-top: 5px; font-size: 0.85em;">üóëÔ∏è Bild entfernen</button>
        </div>
    </div>
    
    <button class="btn btn-small" style="background: #f5576c; color: white;" onclick="saveArticleNote()">
        üíæ Notiz speichern
    </button>
    
    <div class="saved-notes" id="savedNotes">
        <p style="color: #888; text-align: center;">Noch keine Notizen</p>
    </div>
</div>
            
            <!-- Haushalts-Tracker -->
            <div class="card">
                <h2>üîî Haushalts-Reminder</h2>
                
                <div id="householdOverdue" style="margin-bottom: 15px;"></div>
                <div id="householdSoon" style="margin-bottom: 15px;"></div>
                <div id="householdDoneToday" style="margin-bottom: 15px;"></div>
                
                <div style="display: flex; gap: 10px; margin-top: 15px;">
                    <button class="btn btn-small" style="background: #667eea; color: white; flex: 1;" onclick="toggleAllTasks()">
                        <span id="toggleAllText">Alle 25 Aufgaben anzeigen</span>
                    </button>
                    <button class="btn btn-small" style="background: #43e97b; color: white; flex: 1;" onclick="toggleOnDemandTasks()">
                        Bei-Bedarf-Aufgaben
                    </button>
                </div>
                
                <div id="allTasksView" style="display: none; margin-top: 20px; padding: 15px; background: #f8f9fa; border-radius: 10px; max-height: 500px; overflow-y: auto;"></div>
                
                <div id="onDemandView" style="display: none; margin-top: 20px; padding: 15px; background: #f8f9fa; border-radius: 10px;"></div>
                
                <div style="margin-top: 20px; padding: 15px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; border-radius: 10px;">
                    <strong>üìä Deine Haushalts-Stats:</strong><br>
                    <div style="margin-top: 10px; display: grid; grid-template-columns: 1fr 1fr; gap: 10px;">
                        <div>üéØ √úberf√§llig: <strong id="overdueCount">0</strong></div>
                        <div>‚úÖ Diese Woche: <strong id="weeklyDone">0</strong>/<strong id="weeklyTotal">0</strong></div>
                    </div>
                </div>
            </div>
            
            <!-- Haushalts-Rad -->
            <div class="card">
                <h2>üè† Haushalt des Tages (30 Min)</h2>
                <p style="margin-bottom: 10px; color: #666;">Nach Morgenspaziergang, vor Fr√ºhst√ºck</p>
                
                <div id="haushaltsTask" style="background: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%); color: white; padding: 20px; border-radius: 10px; margin: 15px 0; text-align: center;">
                    <div style="font-size: 1.5em; font-weight: bold; margin-bottom: 10px;" id="taskName">Staubsaugen</div>
                    <div style="font-size: 1em; opacity: 0.95;" id="taskDetails">Alle R√§ume, flott durchziehen</div>
                    <div style="font-size: 0.9em; margin-top: 10px; font-style: italic;" id="taskMotivation">"Merz kann warten, dein Boden nicht!" üéµ</div>
                    <div style="font-size: 0.9em; margin-top: 5px; background: rgba(255,255,255,0.2); padding: 5px; border-radius: 5px;" id="taskExtra"></div>
                </div>
                
                <div style="display: flex; gap: 10px; margin-bottom: 10px;">
                    <button class="btn btn-small" style="background: #43e97b; color: white; flex: 1;" onclick="completeHaushaltsTask()">‚úì Erledigt!</button>
                    <button class="btn btn-small" style="background: #f39c12; color: white; flex: 1;" onclick="skipHaushaltsTask()">‚Üí Verschieben</button>
                </div>
                
                <div style="background: #f8f9fa; padding: 10px; border-radius: 8px; margin-top: 15px;">
                    <div style="font-weight: bold; color: #555; margin-bottom: 8px;">‚è±Ô∏è Spezial-Tasks:</div>
                    <button class="btn btn-small" style="background: #3498db; color: white; width: 100%; margin-bottom: 5px;" onclick="startSpecialTask('pool', 10)">üåä Pool-Check (10 Min)</button>
                    <button class="btn btn-small" style="background: #27ae60; color: white; width: 100%;" onclick="startSpecialTask('rasen', 60)">üå± Rasen m√§hen (60 Min)</button>
                </div>
            </div>
            
            <!-- Fortschritt -->
            <div class="card">
                <h2>üìä Fortschritt</h2>
                
                <div class="tracker-item">
                    <div>
                        <span class="tracker-label">üìö Roman (W√∂rter)</span>
                    </div>
                    <div>
                        <span class="tracker-value" id="romanWords">0</span>
                        <button class="increment-btn" onclick="incrementCounter('romanWords', 500)">+500</button>
                        <button class="increment-btn" onclick="incrementCounter('romanWords', 1000)">+1000</button>
                    </div>
                </div>
                
                <div style="margin: 10px 0; display: flex; gap: 8px; align-items: center;">
                    <input type="number" id="manualWordsInput" placeholder="W√∂rter..." style="width: 100px; padding: 5px 10px; border: 2px solid #667eea; border-radius: 5px; font-size: 0.9em;" />
                    <button class="increment-btn" onclick="addManualWords()" style="padding: 5px 15px;">+ Hinzuf√ºgen</button>
                </div>
                
                <div class="progress-bar">
                    <div class="progress-fill" id="romanProgress" style="width: 0%">0%</div>
                </div>
                
                <div class="tracker-item">
                    <div>
                        <span class="tracker-label">üéì BSK Module</span>
                    </div>
                    <div>
                        <span class="tracker-value" id="bskModules">7/10</span>
                        <button class="increment-btn" onclick="incrementBSK()">+1</button>
                    </div>
                </div>
                
                <div class="progress-bar">
                    <div class="progress-fill" id="bskProgress" style="width: 70%">70%</div>
                </div>
                
                <div class="streak-counter">
                    <div class="streak-item">
                        <div class="streak-number" id="kroatischStreak">0</div>
                        <div class="streak-label">Tage Kroatisch</div>
                    </div>
                    <div class="streak-item">
                        <div class="streak-number" id="haushaltStreak">0</div>
                        <div class="streak-label">Tage Haushalt</div>
                    </div>
                </div>
                
                <button class="btn btn-small" style="background: #9b59b6; color: white; width: 48%; margin-right: 2%;" onclick="incrementStreak('kroatisch')">Kroatisch ‚úì</button>
                <button class="btn btn-small" style="background: #43e97b; color: white; width: 48%;" onclick="incrementStreak('haushalt')">Haushalt ‚úì</button>
                
                <div style="margin-top: 20px; padding-top: 20px; border-top: 2px solid #e0e0e0;">
                    <button class="btn btn-small" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; width: 100%;" onclick="dailyCheckIn()">üß† Wie lief's heute?</button>
                </div>
            </div>
        </div>
        
        <!-- Evening Review -->
        <div class="card" id="eveningReview" style="display: none; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white;">
            <h2 style="color: white; border-bottom-color: rgba(255,255,255,0.3);">üåô Tages-Review</h2>
            <div id="reviewContent" style="font-size: 1.1em; line-height: 1.8;"></div>
            <button class="btn btn-small" style="background: rgba(255,255,255,0.2); color: white; margin-top: 15px;" onclick="closeReview()">Verstanden ‚úì</button>
        </div>
        
        <!-- Wochenplaner -->
        <div class="card">
            <h2>üìÖ Wochenplaner</h2>
            <p style="margin-bottom: 15px; color: #666;">Deine festen Zeiten mit Vater sind bereits eingetragen. Ziehe flexible Tasks in die Tage.</p>
            
            <div class="week-planner" id="weekPlanner"></div>
            
            <div style="margin-top: 20px; padding-top: 20px; border-top: 2px solid #e0e0e0;">
                <h3 style="color: #667eea; margin-bottom: 15px;">üì¶ Task-Pool (Drag & Drop)</h3>
                <div id="taskPool" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 10px;">
                    <!-- Tasks werden hier eingef√ºgt -->
                </div>
            </div>
        </div>
        
        <!-- Klaviernoten-Karotte -->
        <div class="card" style="background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%); color: white;">
            <h2 style="color: white; border-bottom-color: rgba(255,255,255,0.3);">üéπ Deine Klavier-Karotte des Tages</h2>
            <div style="background: rgba(255,255,255,0.15); padding: 20px; border-radius: 10px; margin: 15px 0;">
                <div style="font-size: 1.3em; font-weight: bold; margin-bottom: 10px;" id="pianoComposer">Claude Debussy</div>
                <div style="font-size: 1.1em; margin-bottom: 15px;" id="pianoPiece">Clair de Lune</div>
                <div style="font-size: 0.95em; opacity: 0.9; font-style: italic; margin-bottom: 15px;" id="pianoDescription">
                    Ein meditativer Klassiker ‚Äì perfekt f√ºr entspannte Finger und klaren Kopf.
                </div>
                <div style="display: flex; gap: 10px; flex-wrap: wrap;">
                    <a id="pianoYoutube" href="#" target="_blank" style="flex: 1; min-width: 200px; display: inline-block; background: #FF0000; color: white; padding: 12px 20px; border-radius: 8px; text-decoration: none; font-weight: bold; text-align: center; transition: all 0.3s;">
                        ‚ñ∂Ô∏è Jetzt auf YouTube h√∂ren
                    </a>
                    <a id="pianoAppleMusic" href="#" target="_blank" style="flex: 1; min-width: 200px; display: inline-block; background: #FA2D48; color: white; padding: 12px 20px; border-radius: 8px; text-decoration: none; font-weight: bold; text-align: center; transition: all 0.3s;">
                        üéµ In Apple Music √∂ffnen
                    </a>
                </div>
                <a id="pianoLink" href="#" target="_blank" style="display: inline-block; background: rgba(255,255,255,0.3); color: white; padding: 10px 20px; border-radius: 8px; text-decoration: none; font-weight: bold; transition: all 0.3s; margin-top: 10px;">
                    üìÑ Noten bei IMSLP ansehen
                </a>
            </div>
            <div style="background: rgba(255,255,255,0.1); padding: 15px; border-radius: 8px; margin-top: 15px;">
                <strong>ü•ï Karotten-Deal:</strong> Wenn du heute dein Hauptziel erreichst, g√∂nn dir 20 Minuten mit diesem St√ºck!
            </div>
            <button class="btn btn-small" style="background: rgba(255,255,255,0.2); color: white; margin-top: 10px;" onclick="nextPianoPiece()">üé≤ Neuer Vorschlag</button>
        </div>
        
        <!-- Kroatisch Lernmodul -->
        <div class="card" style="margin-bottom: 20px;">
            <h2>üá≠üá∑ Kroatisch f√ºr Mini-Kroaten (15 Min/Tag)</h2>
            
            <div class="dialog-selector">
                <button class="dialog-btn active" onclick="showDialog('kino', this)">üé¨ Kino</button>
                <button class="dialog-btn" onclick="showDialog('schule', this)">üéí Schule</button>
                <button class="dialog-btn" onclick="showDialog('spielplatz', this)">‚öΩ Spielplatz</button>
                <button class="dialog-btn" onclick="showDialog('wetter', this)">üå§Ô∏è Wetter</button>
                <button class="dialog-btn" onclick="showDialog('haustiere', this)">üê∂ Haustiere</button>
            </div>
            <!-- KROATISCH LERN-CASINO (NEU!) -->
<div class="card" style="background: linear-gradient(135deg, #9b59b6 0%, #667eea 100%); color: white;">
    <h2 style="color: white; border-bottom-color: rgba(255,255,255,0.3);">üé∞ Kroatisch Lern-Casino</h2>
    
    <div style="background: rgba(255,255,255,0.15); padding: 20px; border-radius: 10px; margin: 15px 0;">
        <div style="font-size: 1.3em; font-weight: bold; margin-bottom: 15px;">
            üî• Heute's Challenge:
        </div>
        <div id="kroatischChallenge" style="font-size: 1.1em; line-height: 1.6; margin-bottom: 15px;">
            Spiele 2 verschiedene Spiele im Casino!
        </div>
        <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 15px; margin-top: 15px;">
            <div style="background: rgba(255,255,255,0.2); padding: 15px; border-radius: 8px; text-align: center;">
                <div style="font-size: 2em; font-weight: bold;" id="kroatischGamesPlayed">0</div>
                <div style="font-size: 0.9em; opacity: 0.9;">Spiele heute</div>
            </div>
            <div style="background: rgba(255,255,255,0.2); padding: 15px; border-radius: 8px; text-align: center;">
                <div style="font-size: 2em; font-weight: bold;" id="kroatischBestStreak">0</div>
                <div style="font-size: 0.9em; opacity: 0.9;">Bester Streak</div>
            </div>
        </div>
    </div>
    
    <div style="background: rgba(255,255,255,0.1); padding: 15px; border-radius: 10px; margin: 15px 0;">
        <strong style="font-size: 1.1em;">üéÆ 5 Spiele warten auf dich:</strong>
        <ul style="margin-top: 10px; line-height: 2; list-style-position: inside;">
            <li>üéØ Verbpaare-Memory</li>
            <li>üé∞ Pronomen-Roulette</li>
            <li>üëª Pr√§positionen-Horror</li>
            <li>üé∞ Endungen-Slot</li>
            <li>üî• <strong>Adjektiv-Inferno</strong> (NEU!)</li>
        </ul>
    </div>
    
    <a href="kroatisch-lern-casino-INFERNO.html" target="_blank" style="display: block; background: rgba(255,255,255,0.9); color: #9b59b6; padding: 20px; border-radius: 10px; text-decoration: none; font-weight: bold; text-align: center; font-size: 1.2em; transition: all 0.3s; margin-top: 15px;">
        üé∞ ZUM LERN-CASINO ‚Üí
    </a>
    
    <div style="background: rgba(255,255,255,0.1); padding: 10px; border-radius: 8px; margin-top: 15px; text-align: center; font-style: italic;">
        "Uƒçenje je igra! Nema straha!"<br>
        (Lernen ist ein Spiel! Keine Angst!)
    </div>
</div>
            <div id="dialogContent"></div>
            
            <button class="btn btn-small" style="background: #9b59b6; color: white; margin-top: 15px;" onclick="nextDialog()">N√§chster Dialog ‚Üí</button>
        </div>
        
        <div class="achievement" id="achievement"></div>
    </div>
    
    <script>
        // Zeit-Update
        function updateTime() {
            const now = new Date();
            const options = { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric', hour: '2-digit', minute: '2-digit' };
            document.getElementById('currentTime').textContent = now.toLocaleDateString('de-DE', options);
        }
        updateTime();
        setInterval(updateTime, 60000);
        
        // Assistent Check-In
        function assistantCheckIn() {
            const mode = localStorage.getItem('todayMode');
            const modeDate = localStorage.getItem('todayModeDate');
            const today = new Date().toDateString();
            const now = new Date();
            const hour = now.getHours();
            
            // Check if mode is from today
            const hasMode = mode && modeDate === today;
            
            const morningMessages = [
                "Guten Morgen! Die Welt wartet nicht, aber dein Kaffee schon. ‚òï",
                "Putin macht Schei√üe, Merz macht Schei√üe ‚Äì aber dein Tag geh√∂rt DIR! üí™",
                "Fr√ºher Vogel f√§ngt den Wurm. Oder schreibt den Roman. Oder beides! üê¶",
                "Die Mini-Kroaten warten auf dein Kroatisch. Keine Panik, 15 Min reichen! üá≠üá∑",
            ];
            
            const afternoonMessages = [
                "Nachmittag! Zeit f√ºr Artikel-Notizen oder BSK-Vorbereitung? üìù",
                "Kaffee mit Dad gleich? Perfekt ‚Äì danach bist du wieder produktiv! ‚òï",
                "Die H√§lfte des Tages ist rum. Was hast du schon geschafft? (Spoiler: mehr als du denkst!) üéØ",
            ];
            
            const eveningMessages = [
                "Abend! Zeit f√ºr Reflexion. Was lief gut? Was kann warten? üåô",
                "Unterricht gleich? Du schaffst das! Deine Sch√ºler lieben dich! üéì",
                "Feierabend naht. G√∂nn dir was ‚Äì Klavier? Gitarre? Oder einfach F√º√üe hoch? üéπ",
            ];
            
            let messages = [];
            if (hour < 12) messages = morningMessages;
            else if (hour < 18) messages = afternoonMessages;
            else messages = eveningMessages;
            
            let message = messages[Math.floor(Math.random() * messages.length)];
            
            // Add mode-specific messages
            if (hasMode) {
                if (mode === 'roman' && hour < 12) {
                    message = "Roman-Modus l√§uft! X/News zu, Finger auf die Tastatur! üìö";
                } else if (mode === 'artikel' && hour >= 16 && hour < 19) {
                    message = "Artikel-Slot ist jetzt! Deine Notizen warten darauf, ausformuliert zu werden! ‚úçÔ∏è";
                } else if (mode === 'pause') {
                    message = "Sanfter Tag gew√§hlt ‚Äì perfekt! Kleine Schritte sind auch Fortschritt! üåø";
                }
            }
            
            // Check for evening review time
            if (hour === 20 && now.getMinutes() >= 30) {
                showEveningReview();
            }
            
            document.getElementById('assistantOutput').textContent = message;
        }
        
        assistantCheckIn();
        setInterval(assistantCheckIn, 60000); // Update every minute
        
        // Quick Log (Morning Journal)
        function addQuickLog() {
            const input = document.getElementById('quickLogInput');
            const text = input.value.trim();
            
            if (!text) return;
            
            const today = new Date().toDateString();
            let logs = JSON.parse(localStorage.getItem('quickLogs') || '{}');
            
            if (!logs[today]) {
                logs[today] = [];
            }
            
            logs[today].push({
                text: text,
                time: new Date().toLocaleTimeString('de-DE', { hour: '2-digit', minute: '2-digit' })
            });
            
            localStorage.setItem('quickLogs', JSON.stringify(logs));
            input.value = '';
            loadQuickLogs();
            updateDailyOverview();
            showAchievement('Eingetragen! Du bist produktiver als du denkst! üåü');
        }
        
        function loadQuickLogs() {
            const today = new Date().toDateString();
            const logs = JSON.parse(localStorage.getItem('quickLogs') || '{}');
            const todayLogs = logs[today] || [];
            
            const container = document.getElementById('quickLogList');
            
            if (todayLogs.length === 0) {
                container.innerHTML = '<p style="color: #888; text-align: center; font-style: italic;">Noch nichts eingetragen</p>';
            } else {
                container.innerHTML = todayLogs.map(log => `
                    <div style="background: white; padding: 8px 12px; margin: 5px 0; border-radius: 5px; border-left: 3px solid #667eea;">
                        <span style="color: #888; font-size: 0.85em;">${log.time}</span> 
                        <span style="color: #333;">${log.text}</span>
                    </div>
                `).join('');
            }
        }
        
        // Spontaneous Tasks Counter
        function incrementSpontan() {
            const today = new Date().toDateString();
            const key = 'spontanCount_' + today;
            let count = parseInt(localStorage.getItem(key) || '0');
            count++;
            localStorage.setItem(key, count);
            document.getElementById('spontanCounter').textContent = count;
            updateDailyOverview();
            showAchievement('Spontan-Task gez√§hlt! Das z√§hlt alles! üê±');
        }
        
        function loadSpontanCount() {
            const today = new Date().toDateString();
            const key = 'spontanCount_' + today;
            const count = localStorage.getItem(key) || '0';
            document.getElementById('spontanCounter').textContent = count;
        }
        
        // Daily Check-In (Reflection)
        function dailyCheckIn() {
            const romanWords = parseInt(localStorage.getItem('romanWords') || '0');
            const kroatischStreak = parseInt(localStorage.getItem('kroatischStreak') || '0');
            const haushaltStreak = parseInt(localStorage.getItem('haushaltStreak') || '0');
            const today = new Date().toDateString();
            const quickLogs = JSON.parse(localStorage.getItem('quickLogs') || '{}');
            const todayLogs = quickLogs[today] || [];
            const spontanCount = parseInt(localStorage.getItem('spontanCount_' + today) || '0');
            
            let message = "üß† Dein Tages-Check-In:\n\n";
            
            // Quick wins
            if (todayLogs.length > 0) {
                message += `‚úÖ ${todayLogs.length} Dinge erledigt:\n`;
                todayLogs.forEach(log => {
                    message += `  ‚Ä¢ ${log.text}\n`;
                });
                message += "\n";
            }
            
            if (spontanCount > 0) {
                message += `üê± ${spontanCount} spontane Tasks gemeistert!\n\n`;
            }
            
            // Roman
            if (romanWords === 0) {
                message += "üìö Roman: Noch keine W√∂rter heute. Vielleicht heute Abend noch 500? Du schaffst das!\n\n";
            } else {
                message += `üìö Roman: ${romanWords} W√∂rter geschrieben! ${romanWords >= 1000 ? 'CHAMPION! üèÜ' : 'Weiter so! üí™'}\n\n`;
            }
            
            // Kroatisch
            if (kroatischStreak >= 7) {
                message += `üá≠üá∑ Kroatisch-Streak: ${kroatischStreak} Tage! Die Mini-Kroaten werden dich bald verstehen! üî•\n\n`;
            } else if (kroatischStreak >= 3) {
                message += `üá≠üá∑ Kroatisch-Streak: ${kroatischStreak} Tage ‚Äì solide! Weiter so!\n\n`;
            } else {
                message += "üá≠üá∑ Kroatisch: Heute schon 15 Min investiert? Die Nachbarskinder warten! üòä\n\n";
            }
            
            // Haushalt
            if (haushaltStreak >= 7) {
                message += `üè† Haushalt-Streak: ${haushaltStreak} Tage! Dein Haus gl√§nzt! ‚ú®\n\n`;
            } else if (haushaltStreak >= 3) {
                message += `üè† Haushalt-Streak: ${haushaltStreak} Tage ‚Äì nice! Keep going!\n\n`;
            } else {
                message += "üè† Haushalt: 30 Min heute? Ein sauberes Haus = klarer Kopf!\n\n";
            }
            
            message += "Du machst das gro√üartig! Auch wenn's nicht perfekt ist ‚Äì du bleibst dran! üí™";
            
            alert(message);
        }
        
        // Evening Review
        function showEveningReview() {
            const today = new Date().toDateString();
            const lastReview = localStorage.getItem('lastEveningReview');
            
            // Only show once per day
            if (lastReview === today) return;
            
            const romanWords = parseInt(localStorage.getItem('romanWords') || '0');
            const quickLogs = JSON.parse(localStorage.getItem('quickLogs') || '{}');
            const todayLogs = quickLogs[today] || [];
            const spontanCount = parseInt(localStorage.getItem('spontanCount_' + today) || '0');
            const mode = localStorage.getItem('todayMode');
            
            let content = "<strong>So lief dein Tag:</strong><br><br>";
            
            if (todayLogs.length > 0 || spontanCount > 0) {
                content += `‚úÖ Du hast ${todayLogs.length + spontanCount} Dinge erledigt!<br>`;
                content += "Das ist mehr als 'nichts'! üåü<br><br>";
            }
            
            if (mode === 'roman' && romanWords >= 500) {
                content += "üìö Roman-Tag erfolgreich! Weiter so!<br><br>";
            } else if (mode === 'artikel') {
                content += "‚úçÔ∏è Artikel-Modus gew√§hlt ‚Äì hast du deine Notizen ausformuliert?<br><br>";
            } else if (mode === 'pause') {
                content += "üåø Sanfter Tag ‚Äì genau richtig! Morgen geht's weiter!<br><br>";
            }
            
            content += "Morgen ist ein neuer Tag. Schlaf gut! üò¥";
            
            document.getElementById('reviewContent').innerHTML = content;
            document.getElementById('eveningReview').style.display = 'block';
            localStorage.setItem('lastEveningReview', today);
        }
        
        function closeReview() {
            document.getElementById('eveningReview').style.display = 'none';
        }
        
        // Zitate-Rotation
        const quotes = [
            "Perfektion ist der Feind von 'fertig'. Und 'fertig' ist der Freund von 'weiter geht's'.",
            "Putin macht Schei√üe, Merz macht Schei√üe ‚Äì aber dein Roman schreibt sich nicht von selbst!",
            "80% fertig und abgeschickt schl√§gt 100% perfekt im Kopf.",
            "Die Welt kann 90 Minuten ohne deine politische Analyse √ºberleben. Versprochen.",
            "Jeder Mini-Kroate, mit dem du reden kannst, ist ein kleiner Sieg gegen die Isolation.",
            "Dein Vater ist Trump mit Demenz ‚Äì und du schaffst das trotzdem. Respekt!",
            "Fensterputzen = R√ºckentraining. Win-Win f√ºr Haus und K√∂rper.",
            "Das Klavier vermisst dich. Aber es wartet geduldig.",
            "7 Streuner-Katzen f√ºttern = soziales Engagement. Das z√§hlt!",
            "Kleine Erfolge sind auch Erfolge. W√§sche l√§uft? Check! ‚úì",
            "Du bist nicht verzettelt. Du bist vielseitig interessiert. Gro√üer Unterschied!",
            "ADS hei√üt nicht unfokussiert. Es hei√üt hyperfokussiert auf das Richtige. Finde das Richtige!",
            "Dein Dashboard zeigt: Du MACHST Dinge. Du siehst sie nur nicht immer. Jetzt schon!",
            "30 Minuten Haushalt > 3 Stunden Prokrastination. Du wei√üt das!",
            "Kroatisch-Streak l√§uft? Die Mini-Kroaten werden stolz sein! üá≠üá∑"
        ];
        
        function rotateQuote() {
            const quoteBox = document.getElementById('quoteBox');
            const randomQuote = quotes[Math.floor(Math.random() * quotes.length)];
            quoteBox.textContent = randomQuote;
        }
        setInterval(rotateQuote, 30000);
        
        // Morgen-Entscheidung
        function selectMode(mode) {
            const result = document.getElementById('modeResult');
            const text = document.getElementById('modeText');
            
            result.style.display = 'block';
            
            const modes = {
                'artikel': `
                    <strong>‚úçÔ∏è Artikel-Modus aktiviert!</strong><br><br>
                    1. Sammle jetzt Notizen und Stichpunkte<br>
                    2. Schreiben wann du willst - keine festen Zeiten!<br>
                    3. Nur Mo/Di abends Unterricht, sonst flexibel<br><br>
                    <em>Die Welt dreht sich weiter. Deine Gedanken sind gespeichert.</em>
                `,
                'roman': `
                    <strong>üìö Roman-Zeit!</strong><br><br>
                    1. Schlie√üe jetzt X und News-Tabs<br>
                    2. Starte den 90-Min-Timer<br>
                    3. Keine Ablenkungen ‚Äì die Dystopie wartet!<br><br>
                    <em>Europa 2040 braucht dich. Putin kann warten.</em>
                `,
                'pause': `
                    <strong>üåø Sanfter Tag gew√§hlt</strong><br><br>
                    Optionen ohne Druck:<br>
                    ‚Ä¢ 15 Min Kroatisch-Dialog<br>
                    ‚Ä¢ Fenster putzen = R√ºckentraining<br>
                    ‚Ä¢ Spaziergang extra genie√üen<br><br>
                    <em>Auch Pausen sind produktiv. Du bist trotzdem gro√üartig.</em>
                `
            };
            
            text.innerHTML = modes[mode];
            
            // Speichern f√ºr sp√§ter
            localStorage.setItem('todayMode', mode);
            localStorage.setItem('todayModeDate', new Date().toDateString());
        }
        
        // Daily Overview Update
        function updateDailyOverview() {
            const today = new Date().toDateString();
            const quickLogs = JSON.parse(localStorage.getItem('quickLogs') || '{}');
            const todayLogs = quickLogs[today] || [];
            const spontanCount = parseInt(localStorage.getItem('spontanCount_' + today) || '0');
            const deepWorkMins = parseInt(localStorage.getItem('deepWorkMins_' + today) || '0');
            
            // Check streaks completed today
            const lastKroatisch = localStorage.getItem('lastKroatischDate');
            const lastHaushalt = localStorage.getItem('lastHaushaltDate');
            let streaksToday = 0;
            if (lastKroatisch === today) streaksToday++;
            if (lastHaushalt === today) streaksToday++;
            
            // Update display
            document.getElementById('todayQuickLogCount').textContent = todayLogs.length;
            document.getElementById('todaySpontanDisplay').textContent = spontanCount;
            document.getElementById('todayDeepWorkMins').textContent = deepWorkMins;
            document.getElementById('todayStreaksDisplay').textContent = `${streaksToday}/2`;
            
            // Update accomplishments list
            const accomplishmentsDiv = document.getElementById('todayAccomplishments');
            if (todayLogs.length === 0 && spontanCount === 0 && deepWorkMins === 0 && streaksToday === 0) {
                accomplishmentsDiv.innerHTML = '<em style="opacity: 0.7;">Trage deine ersten Erfolge ein...</em>';
            } else {
                let html = '<ul style="margin: 0; padding-left: 20px;">';
                
                if (todayLogs.length > 0) {
                    todayLogs.forEach(log => {
                        html += `<li>${log.text}</li>`;
                    });
                }
                
                if (spontanCount > 0) {
                    html += `<li>üê± ${spontanCount} spontane Tasks gemeistert!</li>`;
                }
                
                if (deepWorkMins > 0) {
                    html += `<li>‚è±Ô∏è ${deepWorkMins} Min konzentriert gearbeitet!</li>`;
                }
                
                if (streaksToday > 0) {
                    const streakNames = [];
                    if (lastKroatisch === today) streakNames.push('Kroatisch');
                    if (lastHaushalt === today) streakNames.push('Haushalt');
                    html += `<li>üî• Streaks: ${streakNames.join(', ')}</li>`;
                }
                
                html += '</ul>';
                accomplishmentsDiv.innerHTML = html;
            }
        }
        
        // Timer
        let timerInterval;
        let remainingSeconds = 0;
        
        function startTimer(minutes) {
            clearInterval(timerInterval);
            remainingSeconds = minutes * 60;
            
            const startMinutes = minutes; // Store for later
            
            document.getElementById('timerStatus').textContent = `${minutes} Minuten laufen...`;
            
            timerInterval = setInterval(() => {
                remainingSeconds--;
                
                const mins = Math.floor(remainingSeconds / 60);
                const secs = remainingSeconds % 60;
                
                document.getElementById('timerDisplay').textContent = 
                    `${mins.toString().padStart(2, '0')}:${secs.toString().padStart(2, '0')}`;
                
                if (remainingSeconds <= 0) {
                    clearInterval(timerInterval);
                    document.getElementById('timerStatus').textContent = '‚è∞ Zeit ist um! Gut gemacht! üéâ';
                    showAchievement('Deep Work abgeschlossen! üèÜ');
                    
                    // Track deep work time
                    const today = new Date().toDateString();
                    const key = 'deepWorkMins_' + today;
                    let totalMins = parseInt(localStorage.getItem(key) || '0');
                    totalMins += startMinutes;
                    localStorage.setItem(key, totalMins);
                    
                    updateDailyOverview();
                }
            }, 1000);
        }
        
        function resetTimer() {
            clearInterval(timerInterval);
            remainingSeconds = 0;
            document.getElementById('timerDisplay').textContent = '90:00';
            document.getElementById('timerStatus').textContent = 'Timer bereit';
        }
        
        // Artikel-Notizen
        function saveArticleNote() {
            const note = document.getElementById('articleNote').value;
            if (!note.trim()) return;
            
            const notes = JSON.parse(localStorage.getItem('articleNotes') || '[]');
            notes.unshift({
                text: note,
                date: new Date().toLocaleString('de-DE')
            });
            localStorage.setItem('articleNotes', JSON.stringify(notes));
            
            document.getElementById('articleNote').value = '';
            loadArticleNotes();
            showAchievement('Notiz gespeichert! ‚úì');
        }
        
        function loadArticleNotes() {
            const notes = JSON.parse(localStorage.getItem('articleNotes') || '[]');
            const container = document.getElementById('savedNotes');
            
            if (notes.length === 0) {
                container.innerHTML = '<p style="color: #888; text-align: center;">Noch keine Notizen</p>';
                return;
            }
            
            container.innerHTML = notes.map((note, index) => {
                // Make URLs clickable
                let text = note.text;
                const urlRegex = /(https?:\/\/[^\s]+)/g;
                text = text.replace(urlRegex, '<a href="$1" target="_blank" style="color: #667eea; text-decoration: underline;">$1</a>');
                
                return `
                    <div class="note-item">
                        <button class="delete-note" onclick="deleteNote(${index})">‚úï</button>
                        <div class="note-date">${note.date}</div>
                        <div>${text}</div>
                    </div>
                `;
            }).join('');
        }
        
        function deleteNote(index) {
            const notes = JSON.parse(localStorage.getItem('articleNotes') || '[]');
            notes.splice(index, 1);
            localStorage.setItem('articleNotes', JSON.stringify(notes));
            loadArticleNotes();
        }
        
        // Haushalts-Tracker System
        const householdTasks = {
            // B√§der (w√∂chentlich = 7 Tage)
            'bad_unten': { name: 'üöø Bad unten', interval: 7, category: 'B√§der' },
            'bad_papa': { name: 'üöø Papas Bad', interval: 7, category: 'B√§der' },
            'bad_oben': { name: 'üöø 2. Bad oben', interval: 7, category: 'B√§der' },
            
            // Zimmer (alle 2 Wochen = 14 Tage)
            'papa_zimmer': { name: 'üò± Papas Zimmer', interval: 14, category: 'Zimmer', special: 'horror' },
            'buero': { name: 'üíº Mein B√ºro', interval: 14, category: 'Zimmer' },
            'wohnbereich': { name: 'üõãÔ∏è Wohn-/Essbereich', interval: 14, category: 'Zimmer' },
            'kueche_aussen': { name: 'üç≥ K√ºche au√üen', interval: 14, category: 'Zimmer' },
            'kueche_innen': { name: 'üç≥ K√ºche innen', interval: 14, category: 'Zimmer' },
            
            // K√ºche Spezial
            'kaffeemaschine': { name: '‚òï Kaffeemaschine entkalken', interval: 28, category: 'K√ºche' },
            
            // Staub & B√∂den
            'staub_eg': { name: 'üßπ Staubwischen EG', interval: 7, category: 'Staub & B√∂den' },
            'boden_eg': { name: 'üß∫ B√∂den wischen EG', interval: 7, category: 'Staub & B√∂den' },
            'boden_og': { name: 'üß∫ B√∂den wischen OG', interval: 14, category: 'Staub & B√∂den' },
            
            // Betten
            'betten': { name: 'üõèÔ∏è Betten wechseln', interval: 14, category: 'W√§sche' },
            
            // Fenster (alle 2 Monate = 60 Tage)
            'fenster_wz': { name: 'ü™ü Fenster Wohnzimmer', interval: 60, category: 'Fenster' },
            'fenster_buero': { name: 'ü™ü Fenster B√ºro', interval: 60, category: 'Fenster' },
            'fenster_oben': { name: 'ü™ü Fenster oben', interval: 60, category: 'Fenster' },
            
            // Garten
            'rasen': { name: 'üå± Rasen m√§hen', interval: 14, category: 'Garten' },
            'hecken': { name: '‚úÇÔ∏è Hecken schneiden', interval: 180, category: 'Garten' },
            'unkraut': { name: 'üåø Unkraut j√§ten', interval: 14, category: 'Garten' },
            
            // Pool
            'pool': { name: 'üåä Pool-Roboter + Chemie', interval: 7, category: 'Pool' },
            
            // Aufr√§umen
            'aufraeumen_buero': { name: 'üìö Aufr√§umen B√ºro', interval: 7, category: 'Aufr√§umen' },
            'aufraeumen_eg': { name: 'üõãÔ∏è Aufr√§umen EG', interval: 7, category: 'Aufr√§umen' }
        };
        
        const onDemandTasks = [
            { id: 'waesche_waschen', name: 'üëï W√§sche waschen' },
            { id: 'waesche_falten', name: 'üëï W√§sche falten' },
            { id: 'terrasse', name: 'üè° Terrasse sauber machen' },
            { id: 'auto', name: 'üöó Auto waschen' }
        ];
        
        function getTaskStatus(taskId) {
            const lastDone = localStorage.getItem(`household_${taskId}`);
            if (!lastDone) return { status: 'overdue', daysSince: 999 };
            
            const lastDate = new Date(lastDone);
            const now = new Date();
            const daysSince = Math.floor((now - lastDate) / (1000 * 60 * 60 * 24));
            
            const task = householdTasks[taskId];
            const yellowThreshold = Math.floor(task.interval * 0.85); // 85% von Intervall
            
            if (daysSince >= task.interval) {
                return { status: 'overdue', daysSince };
            } else if (daysSince >= yellowThreshold) {
                return { status: 'soon', daysLeft: task.interval - daysSince };
            } else {
                return { status: 'ok', daysLeft: task.interval - daysSince };
            }
        }
        
        function markTaskDone(taskId) {
            const today = new Date().toISOString();
            localStorage.setItem(`household_${taskId}`, today);
            
            const task = householdTasks[taskId];
            
            // Special achievement for Papa's room!
            if (task.special === 'horror') {
                showAchievement('üèÜ DU HAST PAPAS ZIMMER √úBERLEBT! +100 Respekt-Punkte! Die n√§chsten 14 Tage geh√∂ren DIR! üí™');
            } else {
                showAchievement(`${task.name} erledigt! ‚úì`);
            }
            
            // Add to today's accomplishments
            const quickLogInput = document.getElementById('quickLogInput');
            quickLogInput.value = task.name.replace(/[üöøüßπüß∫ü™üüå±üåä‚úÇÔ∏èüåø‚òïüç≥üíºüõãÔ∏èüò±üìöüõèÔ∏è]/g, '').trim();
            addQuickLog();
            
            updateHouseholdTracker();
            updateDailyOverview();
        }
        
        function markOnDemandDone(taskId, taskName) {
            showAchievement(`${taskName} erledigt! ‚úì`);
            
            // Add to quick log
            const quickLogInput = document.getElementById('quickLogInput');
            quickLogInput.value = taskName.replace(/[üëïüè°üöó]/g, '').trim();
            addQuickLog();
        }
        
        function updateHouseholdTracker() {
            const overdue = [];
            const soon = [];
            const doneToday = [];
            const all = [];
            
            const today = new Date().toDateString();
            
            Object.entries(householdTasks).forEach(([id, task]) => {
                const status = getTaskStatus(id);
                const lastDone = localStorage.getItem(`household_${id}`);
                const lastDoneToday = lastDone && new Date(lastDone).toDateString() === today;
                
                if (lastDoneToday) {
                    doneToday.push({ id, task, status });
                } else if (status.status === 'overdue') {
                    overdue.push({ id, task, status });
                } else if (status.status === 'soon') {
                    soon.push({ id, task, status });
                }
                
                all.push({ id, task, status, lastDoneToday });
            });
            
            // Update overdue section
            const overdueDiv = document.getElementById('householdOverdue');
            if (overdue.length > 0) {
                overdueDiv.innerHTML = `
                    <div style="background: #fee; padding: 15px; border-radius: 10px; border-left: 5px solid #e74c3c;">
                        <strong style="color: #e74c3c;">üî¥ √úBERF√ÑLLIG (${overdue.length}):</strong><br>
                        <div style="margin-top: 10px; display: flex; flex-direction: column; gap: 8px;">
                            ${overdue.map(({ id, task, status }) => `
                                <button onclick="markTaskDone('${id}')" style="background: white; border: 2px solid #e74c3c; color: #e74c3c; padding: 10px; border-radius: 8px; cursor: pointer; text-align: left; font-weight: bold; transition: all 0.3s;">
                                    ${task.name} <span style="font-weight: normal; opacity: 0.8;">(${status.daysSince >= 365 ? 'Steht aus' : 'seit ' + status.daysSince + ' Tagen!'})</span>
                                </button>
                            `).join('')}
                        </div>
                    </div>
                `;
            } else {
                overdueDiv.innerHTML = '';
            }
            
            // Update soon section
            const soonDiv = document.getElementById('householdSoon');
            if (soon.length > 0) {
                soonDiv.innerHTML = `
                    <div style="background: #fffbea; padding: 15px; border-radius: 10px; border-left: 5px solid #f39c12;">
                        <strong style="color: #f39c12;">üü° BALD F√ÑLLIG (${soon.length}):</strong><br>
                        <div style="margin-top: 10px; display: flex; flex-direction: column; gap: 8px;">
                            ${soon.map(({ id, task, status }) => `
                                <button onclick="markTaskDone('${id}')" style="background: white; border: 2px solid #f39c12; color: #f39c12; padding: 10px; border-radius: 8px; cursor: pointer; text-align: left; font-weight: bold; transition: all 0.3s;">
                                    ${task.name} <span style="font-weight: normal; opacity: 0.8;">(in ${status.daysLeft} ${status.daysLeft === 1 ? 'Tag' : 'Tagen'})</span>
                                </button>
                            `).join('')}
                        </div>
                    </div>
                `;
            } else {
                soonDiv.innerHTML = '';
            }
            
            // Update done today section
            const doneTodayDiv = document.getElementById('householdDoneToday');
            if (doneToday.length > 0) {
                doneTodayDiv.innerHTML = `
                    <div style="background: #eaffea; padding: 15px; border-radius: 10px; border-left: 5px solid #43e97b;">
                        <strong style="color: #27ae60;">‚úÖ HEUTE ERLEDIGT (${doneToday.length}):</strong><br>
                        <div style="margin-top: 10px;">
                            ${doneToday.map(({ task }) => `
                                <div style="padding: 8px; background: white; margin: 5px 0; border-radius: 5px; color: #27ae60; font-weight: bold;">
                                    ${task.name} ‚úì
                                </div>
                            `).join('')}
                        </div>
                    </div>
                `;
            } else {
                doneTodayDiv.innerHTML = '';
            }
            
            // Update all tasks view (grouped by category)
            const allTasksDiv = document.getElementById('allTasksView');
            const categories = {};
            all.forEach(item => {
                if (!categories[item.task.category]) {
                    categories[item.task.category] = [];
                }
                categories[item.task.category].push(item);
            });
            
            allTasksDiv.innerHTML = Object.entries(categories).map(([category, tasks]) => `
                <div style="margin-bottom: 20px;">
                    <strong style="color: #667eea; font-size: 1.1em;">${category}</strong>
                    <div style="margin-top: 8px; display: flex; flex-direction: column; gap: 6px;">
                        ${tasks.map(({ id, task, status, lastDoneToday }) => {
                            let color = status.status === 'overdue' ? '#e74c3c' : status.status === 'soon' ? '#f39c12' : '#43e97b';
                            let statusText = status.status === 'overdue' ? `seit ${status.daysSince} Tagen` : 
                                           status.status === 'soon' ? `in ${status.daysLeft} Tagen` : 
                                           `noch ${status.daysLeft} Tage`;
                            if (lastDoneToday) {
                                color = '#27ae60';
                                statusText = 'heute erledigt ‚úì';
                            }
                            return `
                                <button onclick="markTaskDone('${id}')" style="background: white; border: 2px solid ${color}; color: ${color}; padding: 8px; border-radius: 6px; cursor: pointer; text-align: left; font-weight: bold; transition: all 0.3s; font-size: 0.9em;" ${lastDoneToday ? 'disabled' : ''}>
                                    ${task.name} <span style="font-weight: normal; opacity: 0.8; font-size: 0.9em;">(${statusText})</span>
                                </button>
                            `;
                        }).join('')}
                    </div>
                </div>
            `).join('');
            
            // Update on-demand view
            const onDemandDiv = document.getElementById('onDemandView');
            onDemandDiv.innerHTML = `
                <strong style="color: #667eea;">üëï Bei-Bedarf-Aufgaben</strong>
                <p style="color: #888; font-size: 0.9em; margin: 10px 0;">Kein Timer, nur zum Abhaken!</p>
                <div style="margin-top: 10px; display: flex; flex-direction: column; gap: 8px;">
                    ${onDemandTasks.map(task => `
                        <button onclick="markOnDemandDone('${task.id}', '${task.name}')" style="background: white; border: 2px solid #43e97b; color: #43e97b; padding: 10px; border-radius: 8px; cursor: pointer; text-align: left; font-weight: bold; transition: all 0.3s;">
                            ${task.name}
                        </button>
                    `).join('')}
                </div>
            `;
            
            // Update stats
            document.getElementById('overdueCount').textContent = overdue.length;
            
            // Calculate weekly done
            const weekAgo = new Date();
            weekAgo.setDate(weekAgo.getDate() - 7);
            let weeklyDoneCount = 0;
            let weeklyTotalCount = 0;
            
            Object.entries(householdTasks).forEach(([id, task]) => {
                if (task.interval <= 7) { // Only count weekly tasks
                    weeklyTotalCount++;
                    const lastDone = localStorage.getItem(`household_${id}`);
                    if (lastDone && new Date(lastDone) >= weekAgo) {
                        weeklyDoneCount++;
                    }
                }
            });
            
            document.getElementById('weeklyDone').textContent = weeklyDoneCount;
            document.getElementById('weeklyTotal').textContent = weeklyTotalCount;
        }
        
        function toggleAllTasks() {
            const div = document.getElementById('allTasksView');
            const btn = document.getElementById('toggleAllText');
            if (div.style.display === 'none') {
                div.style.display = 'block';
                btn.textContent = 'Alle Aufgaben ausblenden';
            } else {
                div.style.display = 'none';
                btn.textContent = 'Alle 25 Aufgaben anzeigen';
            }
        }
        
        function toggleOnDemandTasks() {
            const div = document.getElementById('onDemandView');
            if (div.style.display === 'none') {
                div.style.display = 'block';
            } else {
                div.style.display = 'none';
            }
        }
        
        // Haushalts-Rad
        const haushaltsAufgaben = [
            {
                name: 'Staubsaugen',
                details: 'Alle R√§ume, flott durchziehen',
                motivation: '"Merz kann warten, dein Boden nicht!" üéµ',
                extra: 'üéß PODCAST AN!',
                duration: 30
            },
            {
                name: 'B√§der putzen',
                details: 'WC, Dusche, Waschbecken ‚Äì Blitzputz',
                motivation: '"Putin bombt, du schrubbst ‚Äì so l√§uft\'s!" üßΩ',
                extra: '',
                duration: 30
            },
            {
                name: 'Staubwischen',
                details: 'Oberfl√§chen, Regale, weg mit dem Staub',
                motivation: '"Klavier freut sich auf staubfreie Tasten!" üéπ',
                extra: 'üéß Podcast m√∂glich!',
                duration: 30
            },
            {
                name: 'B√∂den wischen',
                details: 'K√ºche, Bad ‚Äì nass durchwischen',
                motivation: '"Fensterputzen = R√ºckentraining, remember?" üí™',
                extra: '',
                duration: 30
            },
            {
                name: 'W√§sche + Betten',
                details: 'Waschen, aufh√§ngen, Betten frisch machen',
                motivation: '"Freitag = Fast Wochenende = Fresh Sheets!" üõèÔ∏è',
                extra: '',
                duration: 30
            },
            {
                name: 'Wocheneinkauf + Kaffee',
                details: 'Kaffeemaschine entkalken/s√§ubern, dann Einkauf',
                motivation: '"Einkauf = Bewegung. Kaffee = Leben." ‚òï',
                extra: '',
                duration: 30
            },
            {
                name: 'Aufr√§umen',
                details: 'Was liegt rum? Alles an seinen Platz',
                motivation: '"Sonntag = Sanfter Tag. Fast geschafft!" üåü',
                extra: '',
                duration: 30
            }
        ];
        
        function loadHaushaltsTask() {
            const today = new Date().getDay(); // 0 = Sonntag, 1 = Montag, etc.
            const taskIndex = localStorage.getItem('haushaltsTaskIndex');
            
            let currentIndex;
            if (taskIndex === null) {
                // Erste Nutzung - nutze Wochentag
                currentIndex = (today === 0) ? 6 : today - 1;
            } else {
                currentIndex = parseInt(taskIndex);
            }
            
            const task = haushaltsAufgaben[currentIndex];
            
            document.getElementById('taskName').textContent = task.name;
            document.getElementById('taskDetails').textContent = task.details;
            document.getElementById('taskMotivation').textContent = task.motivation;
            document.getElementById('taskExtra').textContent = task.extra;
            
            localStorage.setItem('haushaltsTaskIndex', currentIndex);
        }
        
        function completeHaushaltsTask() {
            incrementStreak('haushalt');
            showAchievement('Haushalt geschafft! Du bist ein Champion! üèÜ');
            
            // N√§chste Aufgabe f√ºr morgen
            skipHaushaltsTask();
        }
        
        function skipHaushaltsTask() {
            let currentIndex = parseInt(localStorage.getItem('haushaltsTaskIndex')) || 0;
            currentIndex = (currentIndex + 1) % haushaltsAufgaben.length;
            localStorage.setItem('haushaltsTaskIndex', currentIndex);
            
            loadHaushaltsTask();
            showAchievement('N√§chste Aufgabe geladen! Kein Stress! üòä');
        }
        
        function startSpecialTask(type, minutes) {
            const tasks = {
                pool: {
                    name: 'Pool-Check',
                    details: 'Roboter s√§ubern, Chemie checken, alles kontrollieren'
                },
                rasen: {
                    name: 'Rasen m√§hen',
                    details: 'Mit Podcast! 60 Minuten f√ºr einen perfekten Rasen'
                }
            };
            
            const task = tasks[type];
            
            if (confirm(`${task.name} starten? (${minutes} Minuten)\n${task.details}`)) {
                startTimer(minutes);
                showAchievement(`${task.name} gestartet! Los geht's! üöÄ`);
            }
        }
        
        // Fortschritt
        function incrementCounter(id, amount) {
            const element = document.getElementById(id);
            let current = parseInt(element.textContent);
            current += amount;
            element.textContent = current;
            localStorage.setItem(id, current);
            
            // Update Progressbar
            if (id === 'romanWords') {
                const target = 50000; // Ziel: 50.000 W√∂rter
                const percent = Math.min((current / target) * 100, 100);
                const progressBar = document.getElementById('romanProgress');
                progressBar.style.width = percent + '%';
                progressBar.textContent = Math.round(percent) + '%';
            }
            
            showAchievement(`+${amount} W√∂rter! Weiter so! üöÄ`);
        }
        
        function addManualWords() {
            const input = document.getElementById('manualWordsInput');
            const amount = parseInt(input.value);
            
            if (!amount || amount <= 0) {
                alert('Bitte gib eine g√ºltige Zahl ein!');
                return;
            }
            
            incrementCounter('romanWords', amount);
            input.value = '';
        }
        
        function incrementBSK() {
            const element = document.getElementById('bskModules');
            let [current, total] = element.textContent.split('/').map(Number);
            
            if (current < total) {
                current++;
                element.textContent = `${current}/${total}`;
                localStorage.setItem('bskModules', current);
                
                const percent = (current / total) * 100;
                const progressBar = document.getElementById('bskProgress');
                progressBar.style.width = percent + '%';
                progressBar.textContent = Math.round(percent) + '%';
                
                if (current === total) {
                    showAchievement('üéâ Alle BSK-Module fertig! CHAMPION! üéâ');
                } else {
                    showAchievement(`Modul ${current} abgeschlossen! üí™`);
                }
            }
        }
        
        function incrementStreak(type) {
            const id = type + 'Streak';
            const element = document.getElementById(id);
            let current = parseInt(element.textContent);
            current++;
            element.textContent = current;
            localStorage.setItem(id, current);
            
            // Track date for daily overview
            const today = new Date().toDateString();
            localStorage.setItem(`last${type.charAt(0).toUpperCase() + type.slice(1)}Date`, today);
            
            updateDailyOverview();
            showAchievement(`${type === 'kroatisch' ? 'Kroatisch' : 'Haushalt'} Streak: ${current} Tage! üî•`);
        }
        
        // Achievement Notification
        function showAchievement(text) {
            const achievement = document.getElementById('achievement');
            achievement.textContent = text;
            achievement.style.display = 'block';
            
            setTimeout(() => {
                achievement.style.display = 'none';
            }, 3000);
        }
        
        // Kroatisch Dialoge
        const dialogs = {
            kino: [
                { de: "Wie war es im Kino?", hr: "Kako je bilo u kinu?", audio: "Kako je bilo u kinu?" },
                { de: "Was hast du gesehen?", hr: "≈†to si gledao/gledala?", audio: "≈†to si gledao?" },
                { de: "War der Film gut?", hr: "Je li bio dobar film?", audio: "Je li bio dobar film?" },
                { de: "Mit wem warst du?", hr: "S kim si bio/bila?", audio: "S kim si bio?" },
                { de: "Das klingt toll!", hr: "Zvuƒçi super!", audio: "Zvuƒçi super!" }
            ],
            schule: [
                { de: "Wie war es in der Schule?", hr: "Kako je bilo u ≈°koli?", audio: "Kako je bilo u ≈°koli?" },
                { de: "Was habt ihr heute gelernt?", hr: "≈†to ste danas uƒçili?", audio: "≈†to ste danas uƒçili?" },
                { de: "Hattest du Spa√ü?", hr: "Jesi li se zabavljao/zabavljala?", audio: "Jesi li se zabavljao?" },
                { de: "Was ist dein Lieblingsfach?", hr: "Koji ti je najdra≈æi predmet?", audio: "Koji ti je najdra≈æi predmet?" },
                { de: "Hast du Hausaufgaben?", hr: "Ima≈° li domaƒáu zadaƒáu?", audio: "Ima≈° li domaƒáu zadaƒáu?" }
            ],
            spielplatz: [
                { de: "Was spielst du?", hr: "≈†to igra≈°?", audio: "≈†to igra≈°?" },
                { de: "Kann ich mitspielen?", hr: "Mogu li igrati s vama?", audio: "Mogu li igrati s vama?" },
                { de: "Das sieht nach Spa√ü aus!", hr: "To izgleda zabavno!", audio: "To izgleda zabavno!" },
                { de: "Wie hei√üt dein Freund?", hr: "Kako se zove tvoj prijatelj?", audio: "Kako se zove tvoj prijatelj?" },
                { de: "Passt auf euch auf!", hr: "Pazite se!", audio: "Pazite se!" }
            ],
            wetter: [
                { de: "Wie ist das Wetter heute?", hr: "Kakvo je vrijeme danas?", audio: "Kakvo je vrijeme danas?" },
                { de: "Es ist sch√∂n drau√üen!", hr: "Lijepo je vani!", audio: "Lijepo je vani!" },
                { de: "Wird es regnen?", hr: "Hoƒáe li ki≈°iti?", audio: "Hoƒáe li ki≈°iti?" },
                { de: "Es ist kalt heute.", hr: "Hladno je danas.", audio: "Hladno je danas." },
                { de: "Die Sonne scheint!", hr: "Sunce sija!", audio: "Sunce sija!" }
            ],
            haustiere: [
                { de: "Hast du ein Haustier?", hr: "Ima≈° li kuƒánog ljubimca?", audio: "Ima≈° li kuƒánog ljubimca?" },
                { de: "Wie hei√üt dein Hund?", hr: "Kako se zove tvoj pas?", audio: "Kako se zove tvoj pas?" },
                { de: "Ist er lieb?", hr: "Je li dobar?", audio: "Je li dobar?" },
                { de: "Darf ich ihn streicheln?", hr: "Mogu li ga maziti?", audio: "Mogu li ga maziti?" },
                { de: "S√º√üe Katze!", hr: "Slatka maƒçka!", audio: "Slatka maƒçka!" }
            ]
        };
        
        let currentDialog = 'kino';
        
        function showDialog(type, buttonElement) {
            currentDialog = type;
            
            // Update active button
            document.querySelectorAll('.dialog-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            if (buttonElement) {
                buttonElement.classList.add('active');
            } else {
                // Fallback f√ºr direkte Aufrufe
                document.querySelectorAll('.dialog-btn').forEach((btn, index) => {
                    if (btn.textContent.includes(type)) {
                        btn.classList.add('active');
                    }
                });
            }
            
            const content = document.getElementById('dialogContent');
            const dialog = dialogs[type];
            
            content.innerHTML = dialog.map((line, index) => `
                <div class="kroatisch-dialog">
                    <div class="dialog-line">
                        <div class="german">${line.de}</div>
                        <div class="croatian">${line.hr}</div>
                        <button class="play-audio" onclick="speak('${line.audio}', 'hr-HR')">üîä Anh√∂ren</button>
                    </div>
                </div>
            `).join('');
        }
        
        function speak(text, lang) {
            if ('speechSynthesis' in window) {
                const utterance = new SpeechSynthesisUtterance(text);
                utterance.lang = lang;
                utterance.rate = 0.8;
                speechSynthesis.speak(utterance);
            }
        }
        
        function nextDialog() {
            const types = Object.keys(dialogs);
            const currentIndex = types.indexOf(currentDialog);
            const nextIndex = (currentIndex + 1) % types.length;
            
            // Trigger click on next dialog button
            const buttons = document.querySelectorAll('.dialog-btn');
            buttons[nextIndex].click();
        }
        
        // Klaviernoten-Karotte
        const pianoPieces = [
            {
                composer: "Claude Debussy",
                piece: "Clair de Lune",
                description: "Ein meditativer Klassiker ‚Äì perfekt f√ºr entspannte Finger und klaren Kopf.",
                link: "https://imslp.org/wiki/Suite_bergamasque_(Debussy%2C_Claude)",
                youtube: "https://www.youtube.com/watch?v=CvFH_6DNRCY",
                appleMusic: "https://music.apple.com/de/album/suite-bergamasque-l-75-iii-clair-de-lune/1443408242?i=1443408532"
            },
            {
                composer: "Erik Satie",
                piece: "Gymnop√©die No. 1",
                description: "Minimalismus pur. Langsam, melancholisch, hypnotisierend.",
                link: "https://imslp.org/wiki/3_Gymnop%C3%A9dies_(Satie%2C_Erik)",
                youtube: "https://www.youtube.com/watch?v=S-Xm7s9eGxU",
                appleMusic: "https://music.apple.com/de/album/3-gymnop%C3%A9dies-no-1-lent-et-douloureux/1452550184?i=1452550499"
            },
            {
                composer: "Erik Satie",
                piece: "Gnossienne No. 1",
                description: "Mysteri√∂s und zeitlos. Saties Meisterwerk der Reduktion.",
                link: "https://imslp.org/wiki/Gnossiennes_(Satie%2C_Erik)",
                youtube: "https://www.youtube.com/watch?v=PLFVGwGQcB0",
                appleMusic: "https://music.apple.com/de/album/gnossienne-no-1/1452550184?i=1452550809"
            },
            {
                composer: "Fr√©d√©ric Chopin",
                piece: "Nocturne Op. 9 No. 2",
                description: "Romantik pur. Flie√üend, elegant, wundersch√∂n.",
                link: "https://imslp.org/wiki/Nocturnes%2C_Op.9_(Chopin%2C_Fr%C3%A9d%C3%A9ric)",
                youtube: "https://www.youtube.com/watch?v=9E6b3swbnWg",
                appleMusic: "https://music.apple.com/de/album/nocturne-no-2-in-e-flat-major-op-9-no-2/1569445804?i=1569445813"
            },
            {
                composer: "Ludwig van Beethoven",
                piece: "Mondscheinsonate (1. Satz)",
                description: "Dein Klassiker! D√ºster, meditativ, eindringlich.",
                link: "https://imslp.org/wiki/Piano_Sonata_No.14%2C_Op.27_No.2_(Beethoven%2C_Ludwig_van)",
                youtube: "https://www.youtube.com/watch?v=4Tr0otuiQuU",
                appleMusic: "https://music.apple.com/de/album/piano-sonata-no-14-in-c-sharp-minor-op-27-no-2/1452862080?i=1452862094"
            },
            {
                composer: "Franz Schubert",
                piece: "Impromptu Op. 90 No. 3",
                description: "Flie√üend und vertr√§umt. Schuberts lyrische Seite.",
                link: "https://imslp.org/wiki/4_Impromptus%2C_D.899_(Schubert%2C_Franz)",
                youtube: "https://www.youtube.com/watch?v=FKXQSlv40fM",
                appleMusic: "https://music.apple.com/de/album/4-impromptus-d-899-op-90-no-3-in-g-flat-major/1443999474?i=1443999665"
            },
            {
                composer: "Robert Schumann",
                piece: "Tr√§umerei (Kinderszenen)",
                description: "Kurz, zart, nostalgisch. Perfekt f√ºr zwischendurch.",
                link: "https://imslp.org/wiki/Kinderszenen%2C_Op.15_(Schumann%2C_Robert)",
                youtube: "https://www.youtube.com/watch?v=6z82w0l6kwE",
                appleMusic: "https://music.apple.com/de/album/kinderszenen-op-15-vii-tr%C3%A4umerei/1452572395?i=1452572688"
            },
            {
                composer: "Gabriel Faur√©",
                piece: "Pavane Op. 50",
                description: "Elegisch und wundersch√∂n. Franz√∂sische Eleganz.",
                link: "https://imslp.org/wiki/Pavane%2C_Op.50_(Faur%C3%A9%2C_Gabriel)",
                youtube: "https://www.youtube.com/watch?v=mpgyTl8yqbw",
                appleMusic: "https://music.apple.com/de/album/pavane-op-50-arr-for-piano/1443670836?i=1443671149"
            },
            {
                composer: "Johannes Brahms",
                piece: "Intermezzo Op. 118 No. 2",
                description: "Warm, introspektiv, herbstlich. Brahms' Altersweisheit.",
                link: "https://imslp.org/wiki/6_Piano_Pieces%2C_Op.118_(Brahms%2C_Johannes)",
                youtube: "https://www.youtube.com/watch?v=Yu72dcfN_58",
                appleMusic: "https://music.apple.com/de/album/6-pieces-for-piano-op-118-no-2-intermezzo-in-a-major/1443562009?i=1443562015"
            },
            {
                composer: "Claude Debussy",
                piece: "R√™verie",
                description: "Tr√§umerisch und impressionistisch. Debussy in bester Form.",
                link: "https://imslp.org/wiki/R%C3%AAverie%2C_L.68_(Debussy%2C_Claude)",
                youtube: "https://www.youtube.com/watch?v=QRjllL-MP0U",
                appleMusic: "https://music.apple.com/de/album/r%C3%AAverie-l-68/1443408242?i=1443408809"
            },
            {
                composer: "Fr√©d√©ric Chopin",
                piece: "Prelude Op. 28 No. 4 (in e-moll)",
                description: "Kurz, aber intensiv. Chopins melancholisches Juwel.",
                link: "https://imslp.org/wiki/Preludes%2C_Op.28_(Chopin%2C_Fr%C3%A9d%C3%A9ric)",
                youtube: "https://www.youtube.com/watch?v=ef-4Bv5Ng0w",
                appleMusic: "https://music.apple.com/de/album/24-pr%C3%A9ludes-op-28-no-4-in-e-minor-largo/1569445804?i=1569445818"
            },
            {
                composer: "Erik Satie",
                piece: "Je te veux",
                description: "Ungew√∂hnlich lebhaft f√ºr Satie ‚Äì aber immer noch elegant!",
                link: "https://imslp.org/wiki/Je_te_veux_(Satie%2C_Erik)",
                youtube: "https://www.youtube.com/watch?v=pud8nut9jTE",
                appleMusic: "https://music.apple.com/de/album/je-te-veux/1452550184?i=1452551122"
            }
        ];
        
        function loadPianoPiece() {
            const today = new Date().toDateString();
            let savedDate = localStorage.getItem('pianoPieceDate');
            let savedIndex = localStorage.getItem('pianoPieceIndex');
            
            // New day = new piece
            if (savedDate !== today) {
                savedIndex = Math.floor(Math.random() * pianoPieces.length);
                localStorage.setItem('pianoPieceDate', today);
                localStorage.setItem('pianoPieceIndex', savedIndex);
            }
            
            const piece = pianoPieces[savedIndex || 0];
            displayPianoPiece(piece);
        }
        
        function displayPianoPiece(piece) {
            document.getElementById('pianoComposer').textContent = piece.composer;
            document.getElementById('pianoPiece').textContent = piece.piece;
            document.getElementById('pianoDescription').textContent = piece.description;
            document.getElementById('pianoLink').href = piece.link;
            document.getElementById('pianoYoutube').href = piece.youtube;
            document.getElementById('pianoAppleMusic').href = piece.appleMusic;
        }
        
        function nextPianoPiece() {
            let currentIndex = parseInt(localStorage.getItem('pianoPieceIndex') || '0');
            currentIndex = (currentIndex + 1) % pianoPieces.length;
            localStorage.setItem('pianoPieceIndex', currentIndex);
            localStorage.setItem('pianoPieceDate', new Date().toDateString());
            
            const piece = pianoPieces[currentIndex];
            displayPianoPiece(piece);
            showAchievement('Neue Klavier-Inspiration! üéπ‚ú®');
        }
        
        // Wochenplaner
        // Wochenplaner mit Drag & Drop
        const availableTasks = [
            { id: 'roman', name: 'üìö Roman-Session', duration: '90 Min', color: '#4facfe' },
            { id: 'artikel', name: '‚úçÔ∏è Artikel-Slot', duration: '60-90 Min', color: '#f5576c' },
            { id: 'bsk', name: 'üéì BSK-Vorbereitung', duration: '2-4 Std', color: '#f39c12' },
            { id: 'fenster', name: 'ü™ü Fenster putzen', duration: '45 Min', color: '#43e97b' },
            { id: 'rasen', name: 'üå± Rasen m√§hen', duration: '60 Min', color: '#27ae60' },
            { id: 'klavier', name: 'üéπ Klavier-Zeit', duration: '20 Min', color: '#9b59b6' },
            { id: 'unvorhergesehenes', name: 'üé≤ Unvorhergesehenes', duration: 'flexibel', color: '#e67e22' }
        ];
        
        function initWeekPlanner() {
            const days = ['Mo', 'Di', 'Mi', 'Do', 'Fr', 'Sa', 'So'];
            const planner = document.getElementById('weekPlanner');
            
            const fixedTimes = {
                all: [
                    '07:00-07:30 Spazieren',
                    '14:00 Mittagessen',
                    '16:00 Kaffee',
                    '16:30 Spazieren',
                    '19:00-21:00 Abendessen'
                ],
                mo: ['17:30-20:45 BSK Unterricht'],
                di: ['17:30-20:45 BSK Unterricht']
            };
            
            planner.innerHTML = days.map((day, index) => {
                const dayCode = ['mo', 'di', 'mi', 'do', 'fr', 'sa', 'so'][index];
                const dayTimes = fixedTimes.all.concat(fixedTimes[dayCode] || []);
                
                return `
                    <div class="day-column" data-day="${dayCode}" ondrop="drop(event)" ondragover="allowDrop(event)" ondragleave="dragLeave(event)">
                        <div class="day-header">${day}</div>
                        ${dayTimes.map(time => `<div class="fixed-time">${time}</div>`).join('')}
                        <div class="task-drop-zone" data-day="${dayCode}"></div>
                    </div>
                `;
            }).join('');
            
            // Load saved tasks
            loadWeekTasks();
            
            // Initialize task pool
            initTaskPool();
        }
        
        function initTaskPool() {
            const pool = document.getElementById('taskPool');
            const weekTasks = JSON.parse(localStorage.getItem('weekTasks') || '{}');
            
            pool.innerHTML = availableTasks.map(task => {
                // Check if task is already in a day
                const isUsed = Object.values(weekTasks).some(dayTasks => 
                    dayTasks.some(t => t.id === task.id)
                );
                
                if (isUsed) return '';
                
                return `
                    <div class="task-item in-pool task-${task.id}" 
                         draggable="true" 
                         data-task-id="${task.id}"
                         style="border-left-color: ${task.color}"
                         ondragstart="drag(event)">
                        <strong>${task.name}</strong><br>
                        <span style="font-size: 0.9em; opacity: 0.8;">${task.duration}</span>
                    </div>
                `;
            }).join('') || '<p style="color: #888; text-align: center; grid-column: 1/-1;">Alle Tasks sind verplant! üéâ</p>';
        }
        
        function loadWeekTasks() {
            const weekTasks = JSON.parse(localStorage.getItem('weekTasks') || '{}');
            
            Object.entries(weekTasks).forEach(([day, tasks]) => {
                const dayColumn = document.querySelector(`.day-column[data-day="${day}"]`);
                if (!dayColumn) return;
                
                tasks.forEach(task => {
                    const taskInfo = availableTasks.find(t => t.id === task.id);
                    if (!taskInfo) return;
                    
                    const taskElement = document.createElement('div');
                    taskElement.className = `task-item task-${task.id}`;
                    taskElement.draggable = true;
                    taskElement.dataset.taskId = task.id;
                    taskElement.style.borderLeftColor = taskInfo.color;
                    taskElement.ondragstart = drag;
                    taskElement.innerHTML = `
                        <strong>${taskInfo.name}</strong><br>
                        <span style="font-size: 0.9em; opacity: 0.8;">${taskInfo.duration}</span>
                        <button onclick="removeTask('${day}', '${task.id}')" style="float: right; background: #e74c3c; color: white; border: none; border-radius: 3px; padding: 2px 6px; cursor: pointer; font-size: 0.8em;">‚úï</button>
                    `;
                    
                    dayColumn.appendChild(taskElement);
                });
            });
        }
        
        let draggedElement = null;
        
        function drag(e) {
            draggedElement = e.target;
            e.target.classList.add('dragging');
            e.dataTransfer.effectAllowed = 'move';
            e.dataTransfer.setData('text/html', e.target.innerHTML);
        }
        
        function allowDrop(e) {
            e.preventDefault();
            e.currentTarget.classList.add('drag-over');
        }
        
        function dragLeave(e) {
            e.currentTarget.classList.remove('drag-over');
        }
        
        function drop(e) {
            e.preventDefault();
            e.currentTarget.classList.remove('drag-over');
            
            if (!draggedElement) return;
            
            const taskId = draggedElement.dataset.taskId;
            const targetDay = e.currentTarget.dataset.day;
            
            if (!taskId || !targetDay) return;
            
            // Remove from old location
            const oldDay = draggedElement.closest('.day-column')?.dataset.day;
            if (oldDay) {
                removeTaskFromDay(oldDay, taskId);
            }
            
            // Add to new day
            addTaskToDay(targetDay, taskId);
            
            // Remove from pool if it was there
            draggedElement.remove();
            
            // Refresh display
            document.getElementById('weekPlanner').innerHTML = '';
            initWeekPlanner();
            
            draggedElement.classList.remove('dragging');
            draggedElement = null;
            
            showAchievement('Task verschoben! üìÖ');
        }
        
        function addTaskToDay(day, taskId) {
            const weekTasks = JSON.parse(localStorage.getItem('weekTasks') || '{}');
            if (!weekTasks[day]) weekTasks[day] = [];
            
            // Don't add duplicates
            if (!weekTasks[day].some(t => t.id === taskId)) {
                weekTasks[day].push({ id: taskId });
            }
            
            localStorage.setItem('weekTasks', JSON.stringify(weekTasks));
        }
        
        function removeTaskFromDay(day, taskId) {
            const weekTasks = JSON.parse(localStorage.getItem('weekTasks') || '{}');
            if (weekTasks[day]) {
                weekTasks[day] = weekTasks[day].filter(t => t.id !== taskId);
            }
            localStorage.setItem('weekTasks', JSON.stringify(weekTasks));
        }
        
        function removeTask(day, taskId) {
            removeTaskFromDay(day, taskId);
            
            // Refresh display
            document.getElementById('weekPlanner').innerHTML = '';
            initWeekPlanner();
            
            showAchievement('Task zur√ºck in den Pool! ‚ôªÔ∏è');
        }
        
        // Load gespeicherte Daten
        function loadSavedData() {
            // Roman W√∂rter
            const romanWords = localStorage.getItem('romanWords') || '0';
            document.getElementById('romanWords').textContent = romanWords;
            const target = 50000;
            const percent = Math.min((parseInt(romanWords) / target) * 100, 100);
            document.getElementById('romanProgress').style.width = percent + '%';
            document.getElementById('romanProgress').textContent = Math.round(percent) + '%';
            
            // BSK Module
            const bskModules = localStorage.getItem('bskModules') || '7';
            document.getElementById('bskModules').textContent = `${bskModules}/10`;
            const bskPercent = (parseInt(bskModules) / 10) * 100;
            document.getElementById('bskProgress').style.width = bskPercent + '%';
            document.getElementById('bskProgress').textContent = Math.round(bskPercent) + '%';
            
            // Streaks
            document.getElementById('kroatischStreak').textContent = localStorage.getItem('kroatischStreak') || '0';
            document.getElementById('haushaltStreak').textContent = localStorage.getItem('haushaltStreak') || '0';
            
            // Artikel-Notizen
            loadArticleNotes();
            
            // Heutiger Modus
            const todayMode = localStorage.getItem('todayMode');
            const todayModeDate = localStorage.getItem('todayModeDate');
            if (todayMode && todayModeDate === new Date().toDateString()) {
                selectMode(todayMode);
            }
        }
        
        // Initialisierung
        document.addEventListener('DOMContentLoaded', () => {
            showDialog('kino');
            initWeekPlanner();
            loadSavedData();
            loadHaushaltsTask();
            loadQuickLogs();
            loadSpontanCount();
            assistantCheckIn();
            loadPianoPiece();
            updateDailyOverview();
            updateHouseholdTracker();
            
            // Update daily overview every 30 seconds
            setInterval(updateDailyOverview, 30000);
            // Update household tracker every minute
            setInterval(updateHouseholdTracker, 60000);
        });
    </script>
</body>
</html>
